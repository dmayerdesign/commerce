version: 0.2

phases:
  install:
    commands:
      - npm install
  build:
    commands:
      # Set permissions.
      - chmod a+x qb

      # Build the project.
      - ./qb build --env=$ENVIRONMENT

      # Assemble the bundle.
      - npm install --production
      - cat package.json
      - mkdir bundle

      - cp package.json bundle/
      - cp tsconfig.json bundle/
      - cp tsconfig-paths-bootstrap.js bundle/
      - cp -r dist bundle/
      - cp -r node_modules bundle/

      # Compress the bundle.
      - zip -r bundle.zip bundle/*
artifacts:
  files:
    - bundle.zip
